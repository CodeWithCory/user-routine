(()=>{"use strict";var e={d:(o,t)=>{for(var n in t)e.o(t,n)&&!e.o(o,n)&&Object.defineProperty(o,n,{enumerable:!0,get:t[n]})},o:(e,o)=>Object.prototype.hasOwnProperty.call(e,o),r:e=>{"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})}},o={};e.r(o),e.d(o,{spaCheck:()=>n});var t=function(e,o,t,n){return new(t||(t=Promise))((function(i,s){function r(e){try{a(n.next(e))}catch(e){s(e)}}function d(e){try{a(n.throw(e))}catch(e){s(e)}}function a(e){var o;e.done?i(e.value):(o=e.value,o instanceof t?o:new t((function(e){e(o)}))).then(r,d)}a((n=n.apply(e,o||[])).next())}))};function n(e,o={}){return t(this,void 0,void 0,(function*(){o.tutorialMode&&(o.globalDelay=200);const n=Object.freeze(Object.assign(Object.assign({},{awaitTimeout:15e3,continueOnFailure:!1,displayMessage:!0,displayProgress:!0,displaySpeed:1,globalDelay:500,logCollapse:!1,logProgress:!0,logResult:!0,message:"SPA Check",messageAttribution:"SPA Check",overrideCss:"",separator:" ",tutorialMode:!1}),o)),i=[],s=n.message?`[SPA Check] ${n.message}`:"[SPA Check]",r={paused:!1,errorOccurred:!1,continueActions:!0,documentKeyDownSet:!1,nextButtonPressed:!1};let d;const a={arrow:void 0,arrowShadow:void 0,focusBox:void 0,message:void 0,style:void 0,tooltip:void 0,tooltipShadow:void 0,nextButton:void 0,playButton:void 0,pauseButton:void 0,stopButton:void 0,status:void 0};if(!function(){if("undefined"==typeof document){let e="FAIL: document is undefined. SPA Check can only be used in the browser. Halting execution.";return n.logProgress&&console.error(e),i.push(e),!1}const e=document.querySelector("body > .spa-check");if(e){let o=`FAIL: SPA Check '${e.getAttribute("data-spa-check")}' is already running. Halting execution.`;return n.logProgress&&console.error(o),i.push(o),!1}return!0}()){const e={success:!1,log:i,message:n.message};return w(e,!1),e}(n.displayMessage||n.displayProgress)&&function(){t(this,void 0,void 0,(function*(){a.style=document.createElement("style"),a.style.textContent="\n      body > .spa-check {\n        font: 20px Arial;\n        padding: 18px 12px 6px 12px;\n        z-index: 9999;\n        position: fixed;\n        top: 0;\n        right: 10%;\n        color: black;\n        background-color: rgba(250,250,250,0.8);\n        text-align: center;\n        border-radius: 0 0 12px 12px;\n        max-width: 80vw;\n        overflow: hidden;\n        white-space: nowrap;\n        text-overflow: ellipsis;\n        border: 2px solid rgb(180,180,180);\n        border-top: 0;\n      }\n      body > .spa-check > .spa-check-footer {\n        width: 100%;\n        display: flex;\n        flex-direction: row;\n        align-items: center;\n        line-height: 15px;\n        font-size: 12px;\n        margin-top: 5px;\n      }\n      body .spa-check-footer .spa-check-play {\n        display: none;\n      }\n      body .spa-check-footer .spa-check-play,\n      body .spa-check-footer .spa-check-pause,\n      body .spa-check-footer .spa-check-stop {\n        padding: 4px;\n      }\n      body .spa-check-footer .spa-check-play:hover,\n      body .spa-check-footer .spa-check-pause:hover,\n      body .spa-check-footer .spa-check-stop:hover {\n        cursor: pointer;\n      }\n      body > .spa-check > .spa-check-footer .spa-check-play-icon {\n        width: 0;\n        height: 0;\n        border-top: 5px solid transparent;\n        border-bottom: 5px solid transparent;\n        border-left: 8px solid rgb(191, 191, 191);\n      }\n      body > .spa-check > .spa-check-footer .spa-check-pause-icon {\n        width: 2px;\n        height: 8px;\n        border-left: 3px solid rgb(191, 191, 191);\n        border-right: 3px solid rgb(191, 191, 191);\n        margin: 1px 0;\n      }\n      body > .spa-check > .spa-check-footer .spa-check-stop-icon {\n        height: 8px;\n        width: 8px;\n        background-color: rgb(191, 191, 191);\n      }\n      body .spa-check-footer .spa-check-play:hover .spa-check-play-icon {\n        border-left: 8px solid rgb(80, 80, 80);\n      }\n      body .spa-check-footer .spa-check-pause:hover .spa-check-pause-icon {\n        border-left: 3px solid rgb(80, 80, 80);\n        border-right: 3px solid rgb(80, 80, 80);\n      }\n      body .spa-check-footer .spa-check-stop:hover .spa-check-stop-icon {\n        background-color: rgb(80, 80, 80);\n      }\n      body > .spa-check > .spa-check-footer > .spa-check-status,\n      body > .spa-check > .spa-check-footer > .spa-check-attribution {\n        text-align: left;\n        color: dimgray;\n      }\n      body > .spa-check > .spa-check-footer > .spa-check-status {\n        min-width: 60px;\n        min-height: 15px;\n        margin-left: 5px;\n        font-style: italic;\n      }\n      body > .spa-check > .spa-check-footer > .spa-check-attribution {\n        margin-left: auto;\n        padding-left: 5px;\n      }\n      body > .spa-check-focus-box {\n        z-index: 9997;\n        visibility: hidden;\n        position: absolute;\n        background-color: rgba(255,255,255,0.2);\n        border: 2px solid white;\n        box-shadow: 0 0 0 2px rgb(0,0,0);\n        pointer-events: none;\n      }\n      body > .spa-check-tooltip {\n        z-index: 9999;\n        visibility: hidden;\n        font: 14px Arial;\n        position: absolute;\n        background-color: rgb(245,245,245);\n        color: black;\n        text-align: center;\n        padding: 10px;\n        border-radius: 10px;\n        max-width: 200px;\n      }\n      body > .spa-check-tooltip-error {\n        color: darkred;\n      }\n      body > .spa-check-arrow {\n        z-index: 9999;\n        visibility: hidden;\n        width: 0;\n        height: 0;\n        position: absolute;\n        border-left: 10px solid transparent;\n        border-right: 10px solid transparent;\n        border-bottom: 10px solid rgb(245,245,245); \n      }\n      body > .spa-check-arrow-shadow {\n        z-index: 9998;\n        border-left: 14px solid transparent;\n        border-right: 14px solid transparent;\n        border-bottom: 14px solid rgb(180,180,180);\n        margin: -3px 0 0 -4px;\n      }\n      body > .spa-check-tooltip-shadow {\n        z-index: 9998;\n        color: transparent;\n        border: 2px solid rgb(180,180,180);\n        background-color: rgb(180,180,180);\n        margin: -2px 0 0 -2px;\n        border-radius: 12px;\n      }\n      body > .spa-check-tooltip .spa-check-next-button {\n        display: block;\n        margin: 5px auto 0 auto;\n        border-radius: 5px;\n        padding: 5px;\n        background-color: rgb(220,220,220);\n        border-width: 0;\n        cursor: pointer;\n      }\n      body > .spa-check-fade-in {\n        visibility: visible;\n        animation: spaCheckfadeIn 150ms; \n      }\n      body > .spa-check-fade-out {\n        opacity: 0;\n        animation: spaCheckfadeOut 150ms; \n      }\n      @keyframes spaCheckfadeIn {\n        0% { opacity: 0; }\n        100% { opacity: 1; }\n      }\n      @keyframes spaCheckfadeOut {\n        0% { opacity: 1; }\n        100% { opacity: 0; }\n      }\n    ",a.style.textContent+=n.overrideCss,document.querySelector("body").appendChild(a.style)}))}(),n.logProgress&&(n.logCollapse?console.groupCollapsed(s):console.group(s)),function(e){a.message=document.createElement("div"),a.message.innerHTML=`\n      ${e}\n      <div class="spa-check-footer">\n        <div class="spa-check-play"><div class="spa-check-play-icon"></div></div>\n        <div class="spa-check-pause"><div class="spa-check-pause-icon"></div></div>\n        <div class="spa-check-stop"><div class="spa-check-stop-icon"></div></div>\n        <div class="spa-check-status"></div>\n        <div class="spa-check-attribution">${n.messageAttribution}</div>\n      </div>\n    `,a.message.setAttribute("data-spa-check",e),a.message.classList.add("spa-check"),n.displayMessage||(a.message.style.visibility="hidden"),document.querySelector("body").appendChild(a.message),a.playButton=document.querySelector(".spa-check .spa-check-play"),a.pauseButton=document.querySelector(".spa-check .spa-check-pause"),a.stopButton=document.querySelector(".spa-check .spa-check-stop"),a.status=document.querySelector(".spa-check .spa-check-status"),a.playButton.addEventListener("click",(()=>t(this,void 0,void 0,(function*(){S()})))),a.pauseButton.addEventListener("click",(()=>t(this,void 0,void 0,(function*(){$()})))),a.stopButton.addEventListener("click",(()=>t(this,void 0,void 0,(function*(){yield A("pause button")})))),null===document.onkeydown&&n.logProgress&&!n.tutorialMode&&(document.onkeydown=e=>t(this,void 0,void 0,(function*(){"Escape"===e.key?yield A("escape key"):" "===e.key&&(r.paused?S():$())})),r.documentKeyDownSet=!0)}(n.message);const c=yield function(e,o){return t(this,void 0,void 0,(function*(){let t=!0;return void 0===e?(t=!1,yield P("Missing required argument Action List","",!1)):Array.isArray(e)||"string"==typeof e||(t=!1,yield P("Action list argument is not an Array or string","",!1)),void 0===o||"object"==typeof o&&!Array.isArray(o)||(t=!1,yield P("Options argument is not an Object","",!1)),t}))}(e,o);if(!c)return C();const l=function(e){return"string"==typeof e?e.split("\n").map((e=>e.trimStart())):Array.isArray(e)?e.map((e=>"string"==typeof e?e.trimStart():e)):void 0}(e);for(const e of l){if(!r.continueActions)return C();yield O(n.globalDelay);try{yield p(e)}catch(e){yield P("Unexpected error: "+e.message)}}return C();function p(e){return t(this,void 0,void 0,(function*(){if("string"==typeof e)yield function(e){return t(this,void 0,void 0,(function*(){const o=e.replace("!","").substring(0,3);if("nav"===o){const o=e.split(n.separator)[1];o&&"#"===o[0]?(yield u((()=>{window.location.href=o}),`Navigating to ${o}`,void 0,!n.tutorialMode),M(`Navigated to ${o}`)):yield P("Unexpected nav action, got",e)}else if("cli"===o){const[o,t,i]=yield m(e),s=k(t,i);if(i){const e=h(t);d=void 0,g(e,i,v),d?(yield u((()=>{d.click()}),`Clicking ${d.tagName.toLowerCase()} with text '${i}'`,d,!n.tutorialMode),M(`Clicked text '${i}' inside ${t} (clicked on ${d.tagName.toLowerCase()})`)):yield P("Could not find selector to click",s),d=void 0}else{const e=yield y(t);if(!e)return;yield u((()=>{e.click()}),`Clicking ${e.tagName.toLowerCase()}`,e,!n.tutorialMode),M(`Clicked ${t}`)}}else if("exi"===o){let[o,t,i]=yield m(e),s=!1;"!"===e[0]&&(s=!0);const r=k(t,i);let c,l=!1;if(i){const e=h(t,!1);d=void 0,g(e,i,v),d&&(c=d,l=!0)}else{const e=f(t,!1);e&&(l=!0,c=e)}l&&!s?(n.tutorialMode||(yield B(c,`Confirmed exists: ${r}`,"info")),n.tutorialMode||(yield L()),M(`Confirmed exists: ${r}`)):l||s?l&&s?(n.tutorialMode||(yield B(c,`Incorrectly exists: ${r}`,"error")),n.tutorialMode||(yield L()),yield P(`Incorrectly exists: ${r}`)):!l&&s&&(n.tutorialMode||(yield B(a.message,`Confirmed does not exist: ${r}`,"info",!0)),n.tutorialMode||(yield L()),M(`Confirmed does not exist: ${r}`)):yield P("Did not exist",r),d=void 0}else if("fil"===o){const[o,t,i]=yield x(e),s=yield y(t);if(!s)return;yield u((()=>{s.value=i,s.dispatchEvent(new InputEvent("input"))}),`Filling value of ${s.tagName.toLowerCase()}`,s,!n.tutorialMode),M(`Filled the value of ${t} to '${i}'`)}else if("wri"===o||"app"===o){const[t,i,s]=yield x(e),r=yield y(i);if(!r)return;let d=s||"";"wri"===o?(yield u((()=>{r.textContent=d}),`Writing over ${i}`,r,!n.tutorialMode),M(`Wrote '${d}' over ${i}`)):(yield u((()=>{r.textContent+=d}),`Appending text to ${i}`,r,!n.tutorialMode),M(`Appended '${d}' to ${i}`))}else if("log"===o){let o,t;" "!==n.separator?[o,t]=e.split(n.separator):[o,t]=e.split(/ (.*)/s),yield u((()=>{M(t)}),`${t}`)}else if("com"===o){const[o,t,n]=yield m(e);if(!n)return void(yield P(`Value was not provided for comment action '${e}'`));const i=yield y(t);if(!i)return;yield B(i,n,"info"),yield L()}else if("wai"===o){const[o,i]=e.split(n.separator);M(`Waiting ${Number(i)/1e3} second(s)`),yield u((()=>t(this,void 0,void 0,(function*(){yield function(e){return t(this,void 0,void 0,(function*(){if(e<=n.globalDelay/2)yield D(e);else{const o=e/n.globalDelay*2,t=e%n.globalDelay/2;for(let e=0;e<o;e++)yield O(n.globalDelay/2);yield O(t)}}))}(Number(i))}))),`Waiting ${Number(i)/1e3} second(s)`,void 0,!n.tutorialMode)}else if("awa"===o){let[o,t,i]=yield m(e),s=!1;"!"===e[0]&&(s=!0);const r=n.awaitTimeout/n.globalDelay*2;let c,l=!1;const p=k(t,i);M(`Awaiting ${p}...`);const u=s?`Awaiting ${p} to not exist...`:`Awaiting ${p}...`;n.tutorialMode||(yield B(a.message,u,"info",!0));for(let e=0;e<r;e++){if(i){const e=Array.from(h(t.replace(/>>/g," ")));for(const o of e)if(o&&o.textContent&&o.textContent.toLowerCase().includes(i.toLowerCase())){l=!0,d=void 0,g([o],i,v),c=d;break}}else{const e=f(t);e&&(l=!0,c=e)}if(l&&!s)break;if(!l&&s)break;l=!1,yield O(n.globalDelay/2)}n.tutorialMode||(yield L()),l&&!s?(n.tutorialMode||(yield B(c,`...Found ${p}`,"info")),n.tutorialMode||(yield L()),M(`...Found ${p}`)):l||s?l&&s?(n.tutorialMode||(yield B(c,`...Timed out awaiting ${p} to not exist`,"error")),n.tutorialMode||(yield L()),yield P(`...Timed out awaiting ${p} to not exist`)):!l&&s&&M(`...${p} disappeared`):yield P(`Timed out after ${n.awaitTimeout/1e3} second(s) awaiting`,p)}else""===e||(yield P("Action string keyword not recognized, got",e))}))}(e);else if("function"==typeof e)try{yield u(e,"Running provided function",void 0,!n.tutorialMode),M("Ran provided function")}catch(o){yield L(),yield P("Error running provided function",o+"; function: "+e.toString())}else yield P("Action is not of type string or function, got",typeof e)}))}function u(e,o,n,i=!0){return t(this,void 0,void 0,(function*(){let t=!1;n||(n=a.message?a.message:document.body,t=!0),i&&(yield B(n,o,"info",t)),yield e(),i&&(yield L())}))}function y(e){return t(this,void 0,void 0,(function*(){const o=f(e);return o||(yield P("CSS Selector not found",e.replace(/>>/g," "))),o}))}function f(e,o=!0){const t=e.replace(/>>/g," ");return document.querySelector(t)}function h(e,o=!0){const t=e.replace(/>>/g," ");return document.querySelectorAll(t)}function g(e,o,t=(e=>"SCRIPT"!==e.tagName)){for(const n of e)b(n,o)&&(t(n)&&(d=n),g(Array.from(n.childNodes).filter((e=>{if(t(e))return e})),o,t))}function v(e){return e.click&&"SCRIPT"!==e.tagName}function b(e,o){const t=o.toLowerCase(),n=e.textContent&&e.textContent.toLowerCase().includes(t),i="string"==typeof e.value&&e.value.toLowerCase().includes(t);return n||i}function k(e,o){return`'${e}'`+(o?` containing text '${o}'`:"")}function x(e){return t(this,void 0,void 0,(function*(){if(" "!==n.separator)return e.split(n.separator);const o=e.split(/ ([^\s]+) (.*)/s);return o.length<3&&(yield P("Unexpected input with data, got",e)),o[1]=o[1].replace(/>>/g," "),o}))}function m(e){return t(this,void 0,void 0,(function*(){const o=e.split(n.separator);return" "!==n.separator?o:o.length>2?yield x(e):(o[1]=o[1].replace(/>>/g," "),o)}))}function w(e,o=!0){return t(this,void 0,void 0,(function*(){const t=n.logProgress?"":s;n.logResult&&console.log(`${t} Result:`,e),n.logProgress&&o&&console.groupEnd()}))}function C(){return t(this,void 0,void 0,(function*(){!function(){t(this,void 0,void 0,(function*(){for(const e in a)a[e]&&a[e].parentNode&&a[e].remove&&a[e].remove();r.documentKeyDownSet&&document.onkeydown}))}();const e=!r.errorOccurred,o={success:e,log:i,message:n.message};return M(`Done, success: ${e}`),w(o),o}))}function S(){r.paused=!1,a.playButton.style.display="none",a.pauseButton.style.display="block",a.status.textContent=""}function $(){r.paused=!0,a.playButton.style.display="block",a.pauseButton.style.display="none",a.status.textContent="Paused"}function A(e){return t(this,void 0,void 0,(function*(){a.status.textContent="Stopping",confirm(`[${n.messageAttribution}]: Are you sure you would like to stop '${n.message}'?`)&&(yield function(e){return t(this,void 0,void 0,(function*(){r.continueActions=!1,document.contains(a.tooltip)&&(yield L(!1)),yield P(e,"",!1,!1)}))}(`Stopped by user (${e})`))}))}function B(e,o,i="info",s){return t(this,void 0,void 0,(function*(){if(!n.displayProgress)return;const d=document.body.getBoundingClientRect(),c=e.getBoundingClientRect(),l=s?0:window.pageYOffset||e.scrollTop||document.body.scrollTop,p=window.pageXOffset||e.scrollLeft||document.body.scrollLeft;a.focusBox=document.createElement("div"),a.focusBox.classList.add("spa-check-focus-box"),a.arrow=document.createElement("div"),a.arrow.classList.add("spa-check-arrow"),a.tooltip=document.createElement("div"),a.tooltip.classList.add("spa-check-tooltip"),"error"===i&&a.tooltip.classList.add("spa-check-tooltip-error"),a.tooltip.textContent=o.replace(/>>/g," "),a.nextButton=document.createElement("button"),a.nextButton.textContent="Next",a.nextButton.classList.add("spa-check-next-button"),a.nextButton.addEventListener("click",(()=>{r.nextButtonPressed=!0})),a.tooltip.appendChild(a.nextButton),document.body.appendChild(a.focusBox),document.body.appendChild(a.arrow),document.body.appendChild(a.tooltip);const u=a.tooltip.getBoundingClientRect().width;let y=c.bottom+10+l,f=c.left+p+c.width/2-10,h=c.left+p+c.width/2-u/2;f<8?f=8:d.right+p-f<20&&(f=d.right+p-20),h<0&&(h=0),s&&(a.focusBox.style.display="none",a.arrow.style.display="none",a.tooltip.style.position="fixed",f-=p,y-=5,h-=p),a.arrow.style.top=String(c.bottom+l+2)+"px",a.arrow.style.left=String(f)+"px",a.tooltip.style.top=String(y+2)+"px",a.tooltip.style.left=String(h)+"px",a.focusBox.style.top=String(c.top+l-2)+"px",a.focusBox.style.left=String(c.left+p-2)+"px",a.focusBox.style.width=String(c.width)+"px",a.focusBox.style.height=String(c.height)+"px",a.arrowShadow=a.arrow.cloneNode(!0),a.tooltipShadow=a.tooltip.cloneNode(!0),a.arrowShadow.classList.add("spa-check-arrow-shadow"),a.tooltipShadow.classList.add("spa-check-tooltip-shadow"),document.body.appendChild(a.arrowShadow),document.body.appendChild(a.tooltipShadow),yield function(e){return t(this,void 0,void 0,(function*(){(function(e){var o=e.getBoundingClientRect(),t=Math.max(document.documentElement.clientHeight,window.innerHeight);return!(o.bottom<0||o.top-t>=0)})(e)||(e.scrollIntoView({behavior:"smooth"}),yield O(700))}))}(e),a.focusBox.classList.add("spa-check-fade-in"),a.arrowShadow.classList.add("spa-check-fade-in"),a.tooltipShadow.classList.add("spa-check-fade-in"),a.arrow.classList.add("spa-check-fade-in"),a.tooltip.classList.add("spa-check-fade-in");let g=30*o.length<2e3?30*o.length:2e3;yield O((650+g)/n.displaySpeed)}))}function L(e=!0){return t(this,void 0,void 0,(function*(){n.tutorialMode&&(yield function(){return t(this,void 0,void 0,(function*(){for(r.nextButtonPressed=!1;!r.nextButtonPressed;)yield D(n.globalDelay/2)}))}()),n.displayProgress&&a.focusBox&&a.arrow&&a.tooltip&&a.arrowShadow&&a.tooltipShadow&&(e&&(yield O(500)),a.focusBox.classList.add("spa-check-fade-out"),a.arrow.classList.add("spa-check-fade-out"),a.tooltip.classList.add("spa-check-fade-out"),a.arrowShadow.classList.add("spa-check-fade-out"),a.tooltipShadow.classList.add("spa-check-fade-out"),yield O(150),a.focusBox.remove(),a.tooltip.remove(),a.arrow.remove(),a.tooltipShadow.remove(),a.arrowShadow.remove())}))}function M(e){return t(this,void 0,void 0,(function*(){i.push(e);const o=`* ${e}`;n.logProgress&&console.log(o)}))}function P(e,o,s=n.continueOnFailure,d=!0){return t(this,void 0,void 0,(function*(){r.errorOccurred=!0;let t=e+(o?`: '${o}'`:"");s?t+=". Continuing execution.":(r.continueActions=!1,t+=". Halting execution.");const c="FAIL: "+t;i.push(c),n.logProgress&&console.error(c),d&&(yield B(a.message,c,"error",!0),yield L())}))}function O(e){return t(this,void 0,void 0,(function*(){return yield function(){return t(this,void 0,void 0,(function*(){for(;r.paused&&r.continueActions;)yield D(n.globalDelay/2)}))}(),yield D(e)}))}function D(e){return t(this,void 0,void 0,(function*(){return new Promise((o=>setTimeout(o,e)))}))}}))}exports.spaCheck=o.spaCheck,Object.defineProperty(exports,"__esModule",{value:!0})})();