var that={},__awaiter=that&&that.__awaiter||function(t,e,o,a){return new(o||(o=Promise))((function(n,r){function i(t){try{l(a.next(t))}catch(t){r(t)}}function s(t){try{l(a.throw(t))}catch(t){r(t)}}function l(t){var e;t.done?n(t.value):(e=t.value,e instanceof o?e:new o((function(t){t(e)}))).then(i,s)}l((a=a.apply(t,e||[])).next())}))};function spaCheck(t,e={}){return __awaiter(that,void 0,void 0,(function*(){const o=[],a=Object.freeze(Object.assign(Object.assign({},{continueOnFailure:!1,globalDelay:500,awaitTimeout:15e3,logCollapse:!1,logResult:!0,logUpdates:!0,message:"",messageShowInDOM:!1,messageStyle:"font-size:24px; padding:10px; z-index:9999; position:fixed; top:0; right:10%; color:black; background-color:rgba(222,222,222,0.8);"}),e)),n=a.message?`[SPA Check] ${a.message}`:"[SPA Check]";let r,i=!1,s=!0;return that.main=t=>__awaiter(that,void 0,void 0,(function*(){yield that.messageStart();if(!that.validateInputs(t,e))return that.finish();for(const e of t){if(!s)return that.finish();yield that.sleep(a.globalDelay);try{yield that.do(e)}catch(t){that.error("Unexpected error: "+t.message)}}return that.finish()})),that.finish=()=>{const t=!i,e={success:t,log:o,message:a.message};return that.log(`Done, success: ${t}`),that.messageEnd(e),e},that.do=t=>__awaiter(that,void 0,void 0,(function*(){if("string"==typeof t)yield that.doActionString(t);else if("function"==typeof t)try{yield t(),that.log("Ran provided function")}catch(e){that.error("Error running provided function",e+"; function: "+t.toString())}else that.error("Action is not of type string or function, got",typeof t)})),that.doActionString=t=>__awaiter(that,void 0,void 0,(function*(){const e=t.substring(0,3);if("nav"===e){const e=t.split(" ")[1];e&&"#"===e[0]?(window.location.href=e,that.log(`Navigated to ${e}`)):that.error("Unexpected nav action, got",t)}else if("cli"===e){const[e,o,a]=that.argSplitComplex(t),n=that.getTargetText(o,a);if(a){const t=document.querySelectorAll(o);let e=!1;for(const o of t)if(o&&o.textContent&&o.textContent.toLowerCase().includes(a.toLowerCase())){e=!0,o.click();break}e?that.log(`Clicked ${n}`):that.error("Could not find selector to click",n)}else{const t=that.select(o);if(!t)return;t.click(),that.log(`Clicked ${n}`)}}else if("exi"===e){const[e,o,a]=that.argSplitComplex(t),n=that.getTargetText(o,a);let r=!1;if(a){const t=document.querySelectorAll(o);for(const e of t)if(e&&e.textContent&&e.textContent.toLowerCase().includes(a.toLowerCase())){r=!0;break}}else{document.querySelector(o)&&(r=!0)}r?that.log(`Did exist: ${n}`):that.error("Did not exist",n)}else if("val"===e){const[e,o,a]=that.argSplit(t);if(!that.select(o))return;that.select(o).value=a,that.log(`Set the value of ${o} to ${a}`)}else if("wri"===e||"app"===e){const[o,a,n]=that.argSplit(t),r=that.select(a);if(!r)return;"wri"===e?(r.textContent=n,that.log(`Wrote '${n}' over ${a}`)):(r.textContent+=n,that.log(`Appended '${n}' to ${a}`))}else if("log"===e){const[e,o]=t.split(/ (.*)/s);that.log(o)}else if("wai"===e){const[e,o]=t.split(" ");that.log(`Waiting ${Number(o)/1e3} second(s)`),yield that.sleep(Number(o))}else if("awa"===e){const[e,o,n]=that.argSplitComplex(t),r=a.awaitTimeout/a.globalDelay;let i=!1;const s=that.getTargetText(o,n);that.log(`Awaiting ${s}...`);for(let t=0;t<r;t++){if(n){const t=Array.from(document.querySelectorAll(o));for(const e of t)if(e&&e.textContent&&e.textContent.toLowerCase().includes(n.toLowerCase())){i=!0;break}}else{document.querySelector(o)&&(i=!0)}if(i)break;yield that.sleep(a.globalDelay)}i?that.log(`...Found ${s}`):that.error(`Timed out after ${a.awaitTimeout/1e3} second(s) awaiting`,s)}else""===t||that.error("Action string keyword not recognized, got",t)})),that.select=t=>{const e=document.querySelector(t);return e||that.error("CSS Selector not found",t),e},that.getTargetText=(t,e)=>`'${t}'`+(e?` containing text '${e}'`:""),that.argSplit=t=>{const e=t.split(/ ([^\s]+) (.*)/s);return e.length<3&&that.error(`Unexpected ${e[0]} input with data, got:`,t),e},that.argSplitComplex=t=>{const e=t.split(" ");return e.length>2?that.argSplit(t):e},that.messageStart=()=>__awaiter(that,void 0,void 0,(function*(){yield that.sleep(0),a.logUpdates&&(a.logCollapse?console.groupCollapsed(n):console.group(n)),r=a.messageShowInDOM&&a.message?that.displayMessageInDOM(a.message,a.messageStyle):void 0})),that.messageEnd=t=>{r&&r.remove();const e=a.logUpdates?"":n;a.logResult&&console.log(`${e} Result:`,t),a.logUpdates&&console.groupEnd()},that.displayMessageInDOM=(t,e)=>{var o;const a=document.createElement("p");return a.textContent=t,a.setAttribute("style",e),null===(o=document.querySelector("body"))||void 0===o||o.appendChild(a),a},that.validateInputs=(t,e)=>{let o=!0;return void 0===t?(o=!1,that.error("Missing required argument Action List","",!1)):Array.isArray(t)||(o=!1,that.error("Action list argument is not an Array","",!1)),void 0===e||"object"==typeof e&&!Array.isArray(e)||(o=!1,that.error("Options argument is not an Object","",!1)),o},that.log=t=>{o.push(t);const e=`* ${t}`;a.logUpdates&&console.log(e)},that.error=(t,e,n=a.continueOnFailure)=>{i=!0;let r=`FAIL: ${t}`+(e?`: '${e}'`:"");n?r+=". Continuing execution.":(s=!1,r+=". Halting execution."),o.push(r),console.error(r)},that.sleep=t=>new Promise((e=>setTimeout(e,t))),yield that.main(t)}))}
